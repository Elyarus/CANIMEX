{"version":3,"sources":["get_modificar_delete_animes.js"],"names":["document","addEventListener","options","response","data","animes","tbody","regeneratorRuntime","async","_context3","prev","next","method","headers","Content-Type","awrap","fetch","sent","ok","Error","concat","status","json","console","log","getElementById","anime","tr","createElement","idAnime","textContent","tdTitle","titulo","tdGenres","genero","tdDuration","duracion","tdImage","img","src","imagen","width","alt","add","tdAcciones","btnEliminar","btnModificar","classList","appendChild","t0","forEach","button","event","row","animeId","_response","_data","animeUnico","_context","closest","innerText","trim","value","querySelectorAll","stop","_response2","_data2","_context2","target","alert","location","reload","error"],"mappings":"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","file":"get_modificar_delete_animes.min.js","sourcesContent":["document.addEventListener('DOMContentLoaded', async () => {\r\n    const options = {\r\n        method: 'GET',\r\n        headers: {\r\n            'Content-Type': 'application/json'\r\n        }\r\n    };\r\n\r\n    try {\r\n        const response = await fetch('http://localhost:8080/api/animes', options);\r\n        if (!response.ok) {\r\n            throw new Error(`HTTP error! Status: ${response.status}`);\r\n        }\r\n        const data = await response.json();\r\n        console.log(data);\r\n\r\n        const animes = data;\r\n        const tbody = document.getElementById('bodyTableAnimes');\r\n        \r\n        animes.forEach(anime => {\r\n            const tr = document.createElement('tr');\r\n            const idAnime = document.createElement('td')\r\n            idAnime.textContent = anime.idAnime;\r\n            const tdTitle = document.createElement('td');\r\n            tdTitle.textContent = anime.titulo;\r\n            const tdGenres = document.createElement('td');\r\n            tdGenres.textContent = anime.genero;\r\n            const tdDuration = document.createElement('td');\r\n            tdDuration.textContent = anime.duracion;\r\n            const tdImage = document.createElement('td');\r\n            const img = document.createElement('img');\r\n            img.src = \"../assets/img/\" + anime.imagen;\r\n            img.width = 150;\r\n            img.alt = anime.titulo;\r\n            img.classList.add('img-fluid', 'img-thumbnail');\r\n            const tdAcciones = document.createElement('td');\r\n            const btnEliminar = document.createElement('button');\r\n            btnEliminar.textContent = 'Eliminar';\r\n            btnEliminar.classList.add('btnEliminar');\r\n            const btnModificar = document.createElement('button');\r\n            btnModificar.textContent = 'Modificar';\r\n            btnModificar.classList.add('btnModificar');\r\n            tdAcciones.appendChild(btnEliminar);\r\n            tdAcciones.appendChild(btnModificar);\r\n            tdImage.appendChild(img);\r\n            tr.appendChild(idAnime);\r\n            tr.appendChild(tdTitle);\r\n            tr.appendChild(tdDuration);\r\n            tr.appendChild(tdGenres);\r\n            tr.appendChild(tdImage);\r\n            tr.appendChild(tdAcciones);\r\n            tbody.appendChild(tr);\r\n        });\r\n    } catch (error) {\r\n        console.error('Error fetching animes:', error);\r\n    }\r\n    console.log(document.querySelectorAll('.btnModificar'));\r\n    // agregar eventos despues de crear los botones\r\n    document.querySelectorAll('.btnModificar').forEach(button => {\r\n        button.addEventListener('click', async (event) => {\r\n            console.log(\"hizo click\");\r\n            console.log(event);\r\n            console.log(event.target); // etiqueda de html del button que presiono\r\n            const row = event.target.closest('tr');\r\n            console.log(row);\r\n            const animeId = row.querySelector('td:first-child').innerText.trim(); //de la fila levanta el id del anime por su clase, por un selector hijo primero\r\n\r\n            try {\r\n                const response = await fetch(`http://localhost:8080/api/animes?id=${animeId}`);\r\n                    if(!response.ok){\r\n                        // lanzo una excepcion en caso de que no funcione el fetch, esto se ve en la consola\r\n                        throw new Error('Error al obtener los datos del anime');\r\n                    }\r\n                const data = await response.json();\r\n                const animeUnico = data[0];\r\n                console.log(data);\r\n                // son los id del formulario, como son unicos e irrepetibles dentro del html sabe a quien insertarles los valores\r\n                document.getElementById('id').value = animeUnico.idAnime;\r\n                document.getElementById('titulo').value = animeUnico.titulo;\r\n                document.getElementById('genero').value = animeUnico.genero;\r\n                document.getElementById('duracion').value = animeUnico.duracion;\r\n            } catch (error) {\r\n                console.error('Erorr:', error);\r\n            }\r\n        });\r\n    });\r\n    // evento para eliminar\r\n    document.querySelectorAll('.btnEliminar').forEach(button => {\r\n        button.addEventListener('click', async (event) => {\r\n            const row = event.target.closest('tr');\r\n            const animeId = row.querySelector('td:first-child').innerText.trim();\r\n            try{\r\n                const response = await fetch(`http://localhost:8080/api/animes?id=${animeId}`, {\r\n                    method: 'DELETE',\r\n                    headers: {\r\n                        'Content-Type': 'application/json'\r\n                    }\r\n                });\r\n                if (!response.ok) {\r\n                    alert('Error al eliminar el anime');\r\n                    throw new Error('Error al eliminar el anime');\r\n                }\r\n                const data = await response.json();\r\n                // si da ok muestro alerta que se elimino bien\r\n\r\n                alert('Anime eliminado correctamente');\r\n                console.log(data);\r\n                location.reload(); // recargo la pagina\r\n                \r\n            } catch (error) {\r\n                console.error('Error:', error);\r\n            }\r\n        })\r\n    })\r\n});\r\n"]}